<div id="roles" class="section">
    <h2>Permissions</h2>
    <div class="form-group"><label class="label">Staff Roles</label><select id="staff_roles" multiple style="height:100px"><option value="">None</option><% const staffArr = (settings.staff_roles||'').split(',').filter(Boolean); guildRoles.forEach(r=>{ %><option value="<%= r.id %>" style="color:<%= r.color %>" <%= staffArr.includes(r.id)?'selected':'' %>>@<%= r.name %></option><% }) %></select></div>
    <hr style="border:0;border-top:1px solid var(--border);margin:30px 0">
    <h3>Command Overrides</h3>
    <div id="perms-list" class="item-list">
    <% Object.keys(commandOverrides).forEach(cmd => { %>
        <% const roles = commandOverrides[cmd]; %>
        <% const roleNames = roles.map(rId => (guildRoles.find(r => r.id === rId) || {name: 'Unknown Role'}).name); %>
        <div class="item" data-command="<%= cmd %>">
            <span><strong>/<%= cmd %>:</strong> @<%= roleNames.join(', @') %></span>
            <button class="btn-remove" onclick="removePerm(this)">X</button>
        </div>
    <% }); %>
</div>
    <div class="add-box"><h3>Add Override</h3><div class="add-row">
        <div style="flex:1"><label class="label">Command</label><select id="perm_cmd"><% botCommands.forEach(c=>{ %><option value="<%= c %>">/<%= c %></option><% }) %></select></div>
        <div style="flex:2"><label class="label">Allowed Roles</label><select id="perm_roles" multiple style="height:100px"><% guildRoles.forEach(r=>{ %><option value="<%= r.id %>" style="color:<%= r.color %>"><%= r.name %></option><% }) %></select></div>
        <button class="btn-add" onclick="addPerm()">Add</button>
    </div></div>
</div>
